<!-- Button Project -->
<div class="fixed top-0 left-0 m-4 z-60 flex justify-center">
    <button (click)="goToProjects()"
        class="bg-linear-to-br from-violet-500 to-blue-600 text-white px-4 py-2 rounded-lg cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
            <path fill="currentColor"
                d="M22 4h-8l-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2M2 6H0v14a2 2 0 0 0 2 2h18v-2H2z" />
        </svg>
    </button>
</div>

<!-- Toolbar -->
<div class="fixed top-0 left-0 w-full z-50 flex justify-center py-4">
    <!-- Button Draw, Select, Text, Erase, Save -->
    <div
        class="flex space-x-4 text-white items-center px-4 py-2 rounded-md bg-opacity-90 bg-linear-to-br from-violet-500 to-blue-600 max-w-screen-md">
        <!-- Button draw -->
        <button (click)="enableDraw()" title="Draw" class="cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path fill="currentColor"
                    d="M20.71 7.04c-.34.34-.67.67-.68 1c-.03.32.31.65.63.96c.48.5.95.95.93 1.44s-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24l-.96-.96l-1.42 1.41l-3.75-3.75l3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57l3.75 3.75L6.75 21H3z" />
            </svg>
        </button>
        <!-- Button arrow -->
        <button (click)="enableArrow()" title="Arrow" class="cursor-pointer transform rotate-45">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                    <path stroke-dasharray="20" stroke-dashoffset="20" d="M12 21l0 -17.5">
                        <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.2s" values="20;0" />
                    </path>
                    <path stroke-dasharray="12" stroke-dashoffset="12" d="M12 3l7 7M12 3l-7 7">
                        <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.2s" dur="0.2s"
                            values="12;0" />
                    </path>
                </g>
            </svg>
        </button>

        <!-- Button select -->
        <button (click)="enableSelect()" title="Select" class="cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path fill="currentColor"
                    d="M6.682 3.396a1.088 1.088 0 0 1 1.807-.745l9.951 8.827c.724.642.312 1.84-.655 1.9l-3.117.191l2.092 4.999a2 2 0 0 1-1.062 2.612l-.868.37a2 2 0 0 1-2.626-1.061l-2.226-5.262l-2.323 2.007c-.73.63-1.858.07-1.797-.892z" />
            </svg>
        </button>
        <!-- Button text -->
        <button (click)="addText()" title="Text" class="cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path fill="currentColor" fill-rule="evenodd"
                    d="M4 3h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1m9 6h3.5V7h-9v2H11v8h2z" />
            </svg>
        </button>
        <!-- Button erase -->
        <button (click)="enableErase()" title="Erase" class="cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path fill="currentColor"
                    d="M11.41 5.505C13.08 3.835 13.915 3 14.952 3c1.038 0 1.873.835 3.543 2.505S21 8.01 21 9.048c0 1.037-.835 1.872-2.505 3.542l-4.193 4.194l-7.086-7.086z" />
                <path fill="currentColor"
                    d="m6.156 10.759l7.085 7.085l-.65.65c-.378.379-.713.714-1.018 1.006H21a.75.75 0 0 1 0 1.5H9c-1.016-.025-1.85-.86-3.495-2.505C3.835 16.825 3 15.99 3 14.952c0-1.037.835-1.872 2.505-3.542z" />
            </svg>
        </button>
        <!-- Button save -->
        <button (click)="saveCanvas()" title="Save" class="cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512">
                <path fill="currentColor"
                    d="m465.94 119.76l-73.7-73.7A47.68 47.68 0 0 0 358.3 32H96a64 64 0 0 0-64 64v320a64 64 0 0 0 64 64h320a64 64 0 0 0 64-64V153.7a47.68 47.68 0 0 0-14.06-33.94M120 112h176a8 8 0 0 1 8 8v48a8 8 0 0 1-8 8H120a8 8 0 0 1-8-8v-48a8 8 0 0 1 8-8m139.75 319.91a80 80 0 1 1 76.16-76.16a80.06 80.06 0 0 1-76.16 76.16" />
                <circle cx="256" cy="352" r="48" fill="currentColor" />
            </svg>
        </button>
        <!-- Button generate image with AI -->
        <button (click)="showInput = !showInput" title="Generate Image" class="cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path fill="currentColor"
                    d="m20.713 8.128l-.246.566a.506.506 0 0 1-.934 0l-.246-.566a4.36 4.36 0 0 0-2.22-2.25l-.759-.339a.53.53 0 0 1 0-.963l.717-.319a4.37 4.37 0 0 0 2.251-2.326l.253-.611a.506.506 0 0 1 .942 0l.253.61a4.37 4.37 0 0 0 2.25 2.327l.718.32a.53.53 0 0 1 0 .962l-.76.338a4.36 4.36 0 0 0-2.219 2.251M2.992 3H14v2H4v14l9.292-9.294a1 1 0 0 1 1.415 0L20 15.01V11h2v9.007a1 1 0 0 1-.992.993H2.992A.993.993 0 0 1 2 20.007V3.993A1 1 0 0 1 2.992 3M8 11a2 2 0 1 1 0-4a2 2 0 0 1 0 4" />
            </svg>
        </button>
    </div>
</div>

@if (showInput) {
    <div class="fixed bottom-0 left-0 w-full z-50 flex justify-center py-4 bg-white">
        <input [(ngModel)]="prompt" (keyup.enter)="processSelectionWithAI()" class="p-2 border rounded-md w-3/4" type="text"
            placeholder="Enter prompt for AI">
        <button (click)="processSelectionWithAI()"
            class="p-2 bg-linear-to-br from-violet-500 to-blue-600 text-white rounded-md ml-2 cursor-pointer">Generate</button>
    </div>
}

<!-- Canvas-->
<canvas #canvas class="w-full h-full"></canvas>

@if (status === 'loading') {
    <div class="fixed inset-0 bg-opacity-50 z-50 flex items-center justify-center">
        <div class="absolute inset-0 bg-gray-800 opacity-10 cursor-wait"></div>
        <div class="loader"></div>
    </div>
}